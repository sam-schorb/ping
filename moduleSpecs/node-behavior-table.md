# Node Behavior Table

This table assumes:

- Value range is **1–8**.
- Each node has **one parameter**, default **1** (unless noted as no‑param).
- **Default port layout (single‑input nodes):**
  - **left‑top = main input**
  - **left‑bottom = control input** (if the node accepts control)
  - **right‑top = main output**
- **Control pulses only update the parameter** and **do not pass through**.
- If **control and main input** arrive in the same tick, **control updates first**, then main input is processed with the new parameter.
- Results are **clamped to 1–8**.
- Pulses entering the **output side** are ignored (one‑directional).
- **All pulses arriving in the same tick are processed independently** (polyphonic).
- **Pulse speed and params pass through unchanged** unless a node explicitly overwrites them.
- **Port order indices are 0‑based in code**; this table uses a human‑readable order.
- **Port naming:** _left‑top/left‑bottom_ are on the **left side**. _top‑left/top‑right_ are on the **top edge** (used in mux ordering).
- **Aliases (DSL):** `pulse` may be written as `p`, and fixed constants may be written as `kN()` (e.g., `const3` → `k3()`).
- **Group nodes are dynamic** (defined in project group library) and are not listed here.

> **Multi‑I/O nodes** (multiplexer, demultiplexer, switch) use the explicit port maps below.

| Node                      | Param (1–8)     | Main input                                                                                  | Control input(s)                    | Main output                                                                                  | Behavior                                                                                                                                       | Notes / edge cases                                                                                                                          |
| ------------------------- | --------------- | ------------------------------------------------------------------------------------------- | ----------------------------------- | -------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------- |
| **pulse**                 | output value    | **left‑top** (trigger)                                                                      | **left‑bottom** (sets output value) | **right‑top**                                                                                | Emits **periodically** on a **global base rate**. When triggered, emits a pulse with **default param value** and **internal phase continues**. | Trigger pulse is consumed (not passed through). Period is global (user‑set), not per node.                                                  |
| **output**                | **no param**    | **left‑top**                                                                                | **none** (left‑bottom unused)       | **none**                                                                                     | **Consumes** the pulse and emits an audio event. Pulse **value selects sample slot** (1–8). Any **pulse params** (e.g. `crush`, `lpf`, `hpf`, `decay`) are applied as effects for that playback. | Output is a sink (no pass‑through). Sample slots are user‑defined. Params default if omitted.                                                |
| **multiplexer**           | **no param**    | **left‑top**                                                                                | **none** (left‑bottom unused)       | **6 outputs** (top‑left → top‑right → right‑top → right‑bottom → bottom‑right → bottom‑left) | On pulse, emits duplicates to **all connected outputs**.                                                                                       | Output ordering is fixed to the global ordering above (orientation does not change ordering).                                               |
| **demultiplexer** (merge) | **no param**    | **6 inputs** (top‑left → top‑right → right‑top → right‑bottom → bottom‑right → bottom‑left) | **none** (left‑bottom unused)       | **left‑top**                                                                                 | Forwards any incoming pulses to output; **multiple pulses per tick allowed**.                                                                  | Polyphonic output allowed. Uses same global side order if ordering is needed.                                                               |
| **add**                   | add amount      | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | `out.value = clamp(in.value + param)`                                                                                                          | Stateless.                                                                                                                                  |
| **sub**                   | subtract amount | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | `out.value = clamp(in.value - param)`                                                                                                          | Stateless.                                                                                                                                  |
| **set**                   | set value       | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | `out.value = param` (ignores input value)                                                                                                      | Stateless overwrite.                                                                                                                        |
| **const1**                | **no param**    | **left‑top**                                                                                | **none** (left‑bottom unused)       | **right‑top**                                                                                | `out.value = 1` (ignores input value)                                                                                                          | Fixed‑value constant. **Preserves incoming speed/params**.                                                                                  |
| **const2**                | **no param**    | **left‑top**                                                                                | **none** (left‑bottom unused)       | **right‑top**                                                                                | `out.value = 2` (ignores input value)                                                                                                          | Fixed‑value constant. **Preserves incoming speed/params**.                                                                                  |
| **const3**                | **no param**    | **left‑top**                                                                                | **none** (left‑bottom unused)       | **right‑top**                                                                                | `out.value = 3` (ignores input value)                                                                                                          | Fixed‑value constant. **Preserves incoming speed/params**.                                                                                  |
| **const4**                | **no param**    | **left‑top**                                                                                | **none** (left‑bottom unused)       | **right‑top**                                                                                | `out.value = 4` (ignores input value)                                                                                                          | Fixed‑value constant. **Preserves incoming speed/params**.                                                                                  |
| **const5**                | **no param**    | **left‑top**                                                                                | **none** (left‑bottom unused)       | **right‑top**                                                                                | `out.value = 5` (ignores input value)                                                                                                          | Fixed‑value constant. **Preserves incoming speed/params**.                                                                                  |
| **const6**                | **no param**    | **left‑top**                                                                                | **none** (left‑bottom unused)       | **right‑top**                                                                                | `out.value = 6` (ignores input value)                                                                                                          | Fixed‑value constant. **Preserves incoming speed/params**.                                                                                  |
| **const7**                | **no param**    | **left‑top**                                                                                | **none** (left‑bottom unused)       | **right‑top**                                                                                | `out.value = 7` (ignores input value)                                                                                                          | Fixed‑value constant. **Preserves incoming speed/params**.                                                                                  |
| **const8**                | **no param**    | **left‑top**                                                                                | **none** (left‑bottom unused)       | **right‑top**                                                                                | `out.value = 8` (ignores input value)                                                                                                          | Fixed‑value constant. **Preserves incoming speed/params**.                                                                                  |
| **speed**                 | speed (1–8)     | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Pass through value; set `pulse.speed = param`.                                                                                                 | Default speed = 1. Effective edge delay = `baseDelay / speed`. Speed persists until changed.                                                |
| **decay**                 | decay (1–8)     | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Pass through value; set/overwrite `pulse.params.decay = param`.                                                                               | Used by Audio Integration to map to Dough `end` (sample decay length).                                                                     |
| **crush**                 | crush (1–8)     | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Pass through value; set/overwrite `pulse.params.crush = param`.                                                                               | Audio Integration maps 1–8 to bit‑depth values (16 → 2).                                                                                    |
| **hpf**                   | hpf (1–8)       | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Pass through value; set/overwrite `pulse.params.hpf = param`.                                                                                 | Audio Integration maps 1–8 to cutoff values (100 → 12000).                                                                                 |
| **lpf**                   | lpf (1–8)       | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Pass through value; set/overwrite `pulse.params.lpf = param`.                                                                                 | Audio Integration maps 1–8 to cutoff values (12000 → 100).                                                                                 |
| **switch**                | selection value | **left‑top**                                                                                | **left‑bottom**                     | **6 outputs** (top‑left → top‑right → right‑top → right‑bottom → bottom‑right → bottom‑left) | Routes pulse to output index = **param**. Input value passes through unchanged.                                                                | If param is 7/8, clamp to 6. Output ordering fixed global ordering.                                                                         |
| **block**                 | **no param**    | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | **Pass if control value is even; block if control value is odd** (input pulse value is unchanged when passed).                                 | Stateless.                                                                                                                                  |
| **every**                 | N               | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Pass every Nth pulse; drop others.                                                                                                             | Stateful. If N changes and current count > new N, reduce count via `count % N` to preserve rhythm. Route then advance (default start on 1). |
| **random**                | max value       | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Output value = random integer **1..param**.                                                                                                    | Stateless per pulse; independent rolls.                                                                                                     |
| **counter**               | reset value     | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Increments internal count on each pulse; outputs current count as value. Control resets count to param.                                        | If reset + main pulse same tick: reset first, then count pulse is first in new sequence.                                                    |
| **gtp**                   | threshold       | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Pass if `in.value > param`                                                                                                                     | Stateless.                                                                                                                                  |
| **ltp**                   | threshold       | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Pass if `in.value < param`                                                                                                                     | Stateless.                                                                                                                                  |
| **gtep**                  | threshold       | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Pass if `in.value >= param`                                                                                                                    | Stateless.                                                                                                                                  |
| **ltep**                  | threshold       | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Pass if `in.value <= param`                                                                                                                    | Stateless.                                                                                                                                  |
| **match**                 | target          | **left‑top**                                                                                | **left‑bottom**                     | **right‑top**                                                                                | Pass if `in.value == param`                                                                                                                    | Stateless.                                                                                                                                  |
